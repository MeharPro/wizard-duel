<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wizard Duel Arena</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.158.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.158.0/examples/jsm/"
            }
        }
    </script>
</head>

<body>
    <div id="game-container"></div>

    <!-- LOBBY OVERLAY -->
    <div id="lobby-overlay">
        <div class="lobby-box">
            <h1>âš¡ Wizard Duel Arena</h1>

            <!-- Name & Character -->
            <input type="text" id="username-input" placeholder="Enter your wizard name" value="Wizard">

            <div class="character-select">
                <label>Choose your wizard:</label>
                <div class="character-grid" id="character-grid">
                    <div class="character-option selected" data-character="hary">
                        <div class="char-avatar" style="background: #740001;">H</div>
                        <span>Hary</span>
                    </div>
                    <div class="character-option" data-character="hermine">
                        <div class="char-avatar" style="background: #740001;">He</div>
                        <span>Hermine</span>
                    </div>
                    <div class="character-option" data-character="roon">
                        <div class="char-avatar" style="background: #740001;">R</div>
                        <span>Roon</span>
                    </div>
                    <div class="character-option" data-character="darco">
                        <div class="char-avatar" style="background: #1a472a;">D</div>
                        <span>Darco</span>
                    </div>
                    <div class="character-option" data-character="volmort">
                        <div class="char-avatar" style="background: #111;">V</div>
                        <span>Volmort</span>
                    </div>
                    <div class="character-option" data-character="humbledore">
                        <div class="char-avatar" style="background: #4444aa;">A</div>
                        <span>Humbledore</span>
                    </div>
                    <div class="character-option" data-character="cuna">
                        <div class="char-avatar" style="background: #0e1a40;">L</div>
                        <span>Cuna</span>
                    </div>
                    <div class="character-option" data-character="dellatrix">
                        <div class="char-avatar" style="background: #1a472a;">B</div>
                        <span>Dellatrix</span>
                    </div>
                </div>
            </div>

            <!-- Host/Join Tabs -->
            <div class="lobby-section">
                <h3>Game Settings</h3>
                <div class="setting-row">
                    <label>Time Limit (mins):</label>
                    <input type="number" id="time-limit" value="5" min="1" max="60">
                </div>
                <div class="setting-row">
                    <label>Avada Kedavra Limit:</label>
                    <input type="number" id="avada-limit" value="1" min="0" max="100">
                </div>
            </div>

            <div class="lobby-actions">
                <button id="join-btn" class="primary-btn">Start / Join Game</button>
                <div class="sub-text">Speak spell names to cast!</div>
            </div>
        </div>

        <div class="server-browser">
            <h3>Active Duels</h3>
            <div id="room-list" class="room-list">
                <!-- Rooms populated via JS -->
            </div>
            <button onclick="refreshRooms()" class="refresh-btn">ðŸ”„ Refresh</button>
        </div>
    </div>

    <!-- DEATH OVERLAY -->
    <div id="death-overlay" style="display: none;">
        <div class="death-box">
            <h2>ðŸ’€ You Died!</h2>
            <p>Killed by: <span id="killer-name">Unknown</span></p>
            <div class="respawn-timer">
                Respawning in <span id="respawn-countdown">5</span>s
            </div>
            <button id="respawn-btn" disabled>âš¡ Respawn</button>
        </div>
    </div>

    <!-- GAME UI -->
    <div id="ui-overlay" style="display: none;">
        <div id="crosshair">â—Ž</div>

        <div id="status-bar">
            <div id="player-info">
                <span id="player-name">Wizard</span>
                <span id="player-stats">K: 0 / D: 0</span>
            </div>
            <div id="health-bar">
                <div id="health-fill"></div>
            </div>
            <div id="status-text">READY</div>
        </div>

        <div id="speech-feedback">
            Hold [LEFT CLICK] + Speak to Cast<br>
            <span id="transcription"></span>
        </div>

        <div id="spell-list"></div>

        <div id="scoreboard" style="display: none;">
            <h3>Scoreboard</h3>
            <div id="scores"></div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script type="module" src="client.js"></script>
</body>

</html>